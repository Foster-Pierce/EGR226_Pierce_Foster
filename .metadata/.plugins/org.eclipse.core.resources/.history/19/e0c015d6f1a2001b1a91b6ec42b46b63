#include <FuncsLib.h>
#include "msp.h"

void main(void)
{
    WDT_A->CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;     // stop watchdog timer
    Setup_Init();
    LCD_init();
    adcsetup();
    Keypad_init();
    PrintMainMenu();
    int n=0;
 //   int Open=0;
    double DC=0;
    P2OUT |= BIT0;

    NVIC_EnableIRQ(TA1_N_IRQn);
    NVIC_EnableIRQ(PORT3_IRQn);
    __enable_interrupt();
    while(1){
       int pressed = Keypad_Read();
        switch(n) {
        case 0 :
            PrintMainMenu();
            if(pressed==1)
                n=1;
            else if(pressed==2)
                n=2;
            else if(pressed==3)
                n=3;

            break;

        case 1 :

            if(pressed==1)
            {
                ServoConfig(6000);
                P2OUT &=~ BIT0;
                P2OUT |= BIT1;
           //     Open=1;
            }

            else if (pressed==2)
            {
                ServoConfig(4500);
                P2OUT &=~ BIT1;
                P2OUT |= BIT0;
            //    Open=0;
            }
            else
                ;

            n=0;

            break;

        case 2 :

            DC=Press_Convert(pressed);    //convert key press to duty cycle number
            if(pressed>=1)
                MotorSpeed(DC);

            n=0;

            break;
        case 3 :

            //rgb
                    n=0;

                    break;

        }

    }
}

//ADC
/*
 * ADC14->CTL0 |=1;
            while(!ADC14->IFGR0);

            x = ADC14->MEM[5];

 */
