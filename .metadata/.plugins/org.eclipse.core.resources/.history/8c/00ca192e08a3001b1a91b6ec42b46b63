#include <FuncsLib.h>
#include "msp.h"
#include <stdio.h>
void main(void)
{
    WDT_A->CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;     // stop watchdog timer
    Setup_Init();
    LCD_init();
    adcsetup();
    Keypad_init();
    PrintMainMenu();
    int n=0, Open=0, pressed;
    double DC=0;
    P2OUT |= BIT0;

    NVIC_EnableIRQ(TA1_N_IRQn);
    NVIC_EnableIRQ(PORT3_IRQn);
    __enable_interrupt();


    while(1){

        pressed = Keypad_Read();
        switch(n) {                 //if a state needs to be stayed in, make sure that the case stays the same until something is accomplished then exit
        case 0 :                    //Main Menu
            PrintMainMenu();
            if(pressed==1)
                n=1;
            else if(pressed==2)
                n=2;
            else if(pressed==3)
                n=3;

            break;

        case 1 :                    //Door Menu
            PrintSubMenu1();
            if(pressed==1)
            {
                ServoConfig(6000);
                P2OUT &=~ BIT0;
                P2OUT |= BIT1;
                //     Open=1;
            }

            else if (pressed==2)
            {
                ServoConfig(4500);
                P2OUT &=~ BIT1;
                P2OUT |= BIT0;
                //    Open=0;
            }
            else if (pressed==10){
                n=0;
                break;
            }

            break;

        case 2 :                        //Motor Menu
            PrintSubMenu2();
            DC=Press_Convert(pressed);    //convert key press to duty cycle number
            if(pressed>=1)
                MotorSpeed(DC);
            else if (pressed==10){
                n=0;
                break;
            }
            n=0;

            break;
        case 3 :                        //RGB Menu
            //print menu
            //rgb
            n=0;

            break;

        }
        ADC14->CTL0 |=1;        //P5.5 from potentiometer
        while(!ADC14->IFGR0);
        int x = ADC14->MEM[5];
        printf("%d",x);



    }
}
